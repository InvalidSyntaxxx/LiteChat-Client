(function(e){function t(t){for(var a,n,s=t[0],c=t[1],i=t[2],d=0,p=[];d<s.length;d++)n=s[d],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&p.push(o[n][0]),o[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);f&&f(t);while(p.length)p.shift()();return u.push.apply(u,i||[]),r()}function r(){for(var e,t=0;t<u.length;t++){for(var r=u[t],a=!0,n=1;n<r.length;n++){var s=r[n];0!==o[s]&&(a=!1)}a&&(u.splice(t--,1),e=c(c.s=r[0]))}return e}var a={},n={app:0},o={app:0},u=[];function s(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-9e45e2d8":"f120d968"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.e=function(e){var t=[],r={"chunk-9e45e2d8":1};n[e]?t.push(n[e]):0!==n[e]&&r[e]&&t.push(n[e]=new Promise((function(t,r){for(var a="css/"+({}[e]||e)+"."+{"chunk-9e45e2d8":"f5a7f610"}[e]+".css",o=c.p+a,u=document.getElementsByTagName("link"),s=0;s<u.length;s++){var i=u[s],d=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(d===a||d===o))return t()}var p=document.getElementsByTagName("style");for(s=0;s<p.length;s++){i=p[s],d=i.getAttribute("data-href");if(d===a||d===o)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var a=t&&t.target&&t.target.src||o,u=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");u.code="CSS_CHUNK_LOAD_FAILED",u.request=a,delete n[e],f.parentNode.removeChild(f),r(u)},f.href=o;var g=document.getElementsByTagName("head")[0];g.appendChild(f)})).then((function(){n[e]=0})));var a=o[e];if(0!==a)if(a)t.push(a[2]);else{var u=new Promise((function(t,r){a=o[e]=[t,r]}));t.push(a[2]=u);var i,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=s(e);var p=new Error;i=function(t){d.onerror=d.onload=null,clearTimeout(f);var r=o[e];if(0!==r){if(r){var a=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+a+": "+n+")",p.name="ChunkLoadError",p.type=a,p.request=n,r[1](p)}o[e]=void 0}};var f=setTimeout((function(){i({type:"timeout",target:d})}),12e4);d.onerror=d.onload=i,document.head.appendChild(d)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(r,a,function(t){return e[t]}.bind(null,a));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],d=i.push.bind(i);i.push=t,i=i.slice();for(var p=0;p<i.length;p++)t(i[p]);var f=d;u.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},1:function(e,t){},2392:function(e,t,r){"use strict";var a=r("cebe"),n=r.n(a),o=(r("d3b7"),r("a78e")),u=r.n(o),s=function(e){var t=u.a.get("token");return e.headers.token=t,e},c=function(e){return Promise.reject(e)},i=function(e){return e},d=function(e){return Promise.reject(e)},p="/api",f=n.a.create({timeout:6e4,baseURL:p,headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});f.interceptors.request.use(s,c),f.interceptors.response.use(i,d);t["a"]=f},"3fff":function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return n}));var a="LiteChat聊天室",n="https://images.weserv.nl/?url=https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/453b8ebcdefa46a69c620da13f346ce2~tplv-k3u1fbpfcp-zoom-1.image?imageView2/2/w/800/q/85"},"48b8":function(e,t,r){"use strict";r.d(t,"g",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"e",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return d})),r.d(t,"f",(function(){return p}));r("c975"),r("4d63"),r("ac1f"),r("25f0");var a=r("8bbf"),n=r.n(a);function o(e){var t=e.data,r=t.code,a=t.msg,o=t.data;if(!r)return a&&n.a.prototype.$message.success(a),o;n.a.prototype.$message.error(a)}function u(e,t){return t.indexOf(e)>=0}function s(e){return e}function c(e){var t=new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/);return t.test(e)}function i(e){var t=n.a.prototype.$moment;return t().add(-1,"days").startOf("day")>e?t(e).format("M/D HH:mm"):t().startOf("day")>e?"昨天 "+t(e).format("HH:mm"):(new Date).valueOf()>e+3e5?t(e).format("HH:mm"):t(e).format("HH:mm:ss")}function d(e){var t=/^(?!_)(?!.*?_$)[a-zA-Z0-9_\u4e00-\u9fa5]+$/;return 0===e.length?(n.a.prototype.$message.error("请输入名字"),!1):t.test(e)?!(e.length>9)||(n.a.prototype.$message.error("名字太长"),!1):(n.a.prototype.$message.error("名字只含有汉字、字母、数字和下划线 不能以下划线开头和结尾"),!1)}function p(e){var t=/^[0-9A-Z_a-z]+$/gi;return 0===e.length?(n.a.prototype.$message.error("请输入密码"),!1):t.test(e)?!(e.length>9)||(n.a.prototype.$message.error("密码太长"),!1):(n.a.prototype.$message.error("密码只含有字母、数字和下划线"),!1)}},5880:function(e,t){e.exports=Vuex},"5c0b":function(e,t,r){"use strict";var a=r("9c0c"),n=r.n(a);n.a},6389:function(e,t){e.exports=VueRouter},"8bbf":function(e,t){e.exports=Vue},"9c0c":function(e,t,r){},c32d:function(e,t){e.exports=moment},cd49:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("8bbf"),n=r.n(a),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("router-view"),e.background?r("img",{staticClass:"background",attrs:{src:e.background,alt:""}}):e._e()],1)},u=[],s=(r("ac1f"),r("466d"),r("498a"),r("d4ec")),c=r("bee2"),i=r("262e"),d=r("2caf"),p=r("9ab4"),f=r("60a3"),g=r("4bb5"),m=r("3fff"),h=Object(g["a"])("app"),l=function(e){Object(i["a"])(r,e);var t=Object(d["a"])(r);function r(){return Object(s["a"])(this,r),t.apply(this,arguments)}return Object(c["a"])(r,[{key:"mounted",value:function(){this.setMobile(this.isMobile()),this.background&&this.background.trim().length||this.set_background(m["a"])}},{key:"isMobile",value:function(){var e=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);return e&&e.length}}]),r}(f["c"]);Object(p["a"])([h.Getter("user")],l.prototype,"user",void 0),Object(p["a"])([h.Getter("background")],l.prototype,"background",void 0),Object(p["a"])([h.Mutation("set_mobile")],l.prototype,"setMobile",void 0),Object(p["a"])([h.Mutation("set_background")],l.prototype,"set_background",void 0),l=Object(p["a"])([f["a"]],l);var b=l,v=b,y=(r("5c0b"),r("2877")),I=Object(y["a"])(v,o,u,!1,null,null,null),O=I.exports,j=(r("d3b7"),r("6389")),k=r.n(j);n.a.use(k.a);var w,G,_=[{path:"/",name:"Chat",component:function(){return r.e("chunk-9e45e2d8").then(r.bind(null,"edc5"))}}],x=new k.a({mode:"history",base:"/",routes:_}),$=x,R=r("5880"),S=r.n(R),P=r("5530"),M=(r("96cf"),r("1da1")),C="set_user",D="clear_user",E="set_token",T="set_mobile",A="set_background",H=r("2392"),N=r("48b8"),B={register:function(e,t){return Object(M["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,r.next=3,H["a"].post("/auth/register",Object(P["a"])({},t));case 3:if(n=r.sent,o=Object(N["g"])(n),!o){r.next=9;break}return a(C,o.user),a(E,o.token),r.abrupt("return",o);case 9:case"end":return r.stop()}}),r)})))()},login:function(e,t){return Object(M["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,r.next=3,H["a"].post("/auth/login",Object(P["a"])({},t));case 3:if(n=r.sent,o=Object(N["g"])(n),!o){r.next=9;break}return a(C,o.user),a(E,o.token),r.abrupt("return",o);case 9:case"end":return r.stop()}}),r)})))()}},L=B,U=r("ade3"),F=r("a78e"),z=r.n(F),V=(w={},Object(U["a"])(w,C,(function(e,t){e.user=t,z.a.set("user",t,{expires:3650})})),Object(U["a"])(w,D,(function(e){e.user={userId:"",username:"",password:"",avatar:"",createTime:0},z.a.set("user","")})),Object(U["a"])(w,E,(function(e,t){e.token=t,z.a.set("token",t,{expires:3})})),Object(U["a"])(w,T,(function(e,t){e.mobile=t})),Object(U["a"])(w,A,(function(e,t){e.background=t,localStorage.setItem("background",t)})),w),q=V,J={user:function(e){e.user;var t=z.a.get("user");return t?(e.user=JSON.parse(t),e.user):{}},mobile:function(e){return e.mobile},background:function(e){return e.background,localStorage.getItem("background")}},Q=J,W={user:{userId:"",username:"",password:"",avatar:"",createTime:0},token:"",mobile:!1,background:""},Z=W,K={namespaced:!0,state:Z,mutations:q,actions:L,getters:Q},X=K,Y=(r("99af"),r("b85c")),ee=r("8055"),te=r.n(ee),re="set_socket",ae="set_dropped",ne="set_active_group_user",oe="set_active_room",ue="set_user_gather",se="set_friend_gather",ce="set_group_gather",ie="add_group_message",de="set_group_messages",pe="add_friend_message",fe="set_friend_messages",ge="del_group",me="del_friend",he="set_unread_gather",le="lose_unread_gather",be={connectSocket:function(e,t){return Object(M["a"])(regeneratorRuntime.mark((function t(){var r,a,o,u,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.commit,a=e.state,o=e.dispatch,u=e.rootState,s=u.app.user,c=te.a.connect("/?userId=".concat(s.userId),{reconnection:!0}),c.on("connect",Object(M["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:c.emit("chatData",s),r(re,c);case 3:case"end":return e.stop()}}),e)})))),c.on("activeGroupUser",(function(e){r(ne,e.data)})),c.on("addGroup",(function(e){if(e.code)return n.a.prototype.$message.error(e.msg);n.a.prototype.$message.success(e.msg),r(ce,e.data)})),c.on("joinGroup",function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(t){var o,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.code){e.next=3;break}return e.abrupt("return",n.a.prototype.$message.error(t.msg));case 3:if(o=t.data.user,u=t.data.group,o.userId==s.userId){e.next=10;break}return r(ue,o),e.abrupt("return",n.a.prototype.$message.info("".concat(o.username,"加入群").concat(u.groupName)));case 10:a.groupGather[u.groupId]||(r(ce,u),c.emit("chatData",s)),n.a.prototype.$message.info("成功加入群".concat(u.groupName)),r(oe,a.groupGather[u.groupId]);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c.on("joinGroupSocket",(function(e){if(e.code)return n.a.prototype.$message.error(e.msg);var t=e.data.user,o=e.data.group,u=a.friendGather;if(t.userId!=s.userId){var c;if(r(ue,t),u[t.userId])u[t.userId].messages&&(c=u[t.userId].messages),r(se,t),r(fe,c);if(window.msg===t.userId)return;return window.msg=t.userId,n.a.prototype.$message.info("".concat(t.username,"加入群").concat(o.groupName))}a.groupGather[o.groupId]||r(ce,o),r(ue,t)})),c.on("groupMessage",(function(e){if(e.code)n.a.prototype.$message.error(e.msg);else{r(ie,e.data);var t=a.activeRoom;t&&t.groupId!==e.data.groupId&&r(he,e.data.groupId)}})),c.on("addFriend",(function(e){e.code?n.a.prototype.$message.error(e.msg):(r(se,e.data),r(ue,e.data),n.a.prototype.$message.info(e.msg),c.emit("joinFriendSocket",{userId:s.userId,friendId:e.data.userId}))})),c.on("joinFriendSocket",(function(e){e.code})),c.on("friendMessage",(function(e){if(e.code)n.a.prototype.$message.error(e.msg);else if(e.data.friendId===s.userId||e.data.userId===s.userId){r(pe,e.data);var t=a.activeRoom;t&&t.userId!==e.data.userId&&t.userId!==e.data.friendId&&r(he,e.data.userId)}})),c.on("chatData",(function(e){if(e.code)return n.a.prototype.$message.error(e.msg);o("handleChatData",e.data),r(ae,!1)})),c.on("exitGroup",(function(e){e.code?n.a.prototype.$message.error(e.msg):(r(ge,e.data),r(oe,a.groupGather[m["b"]]),n.a.prototype.$message.success(e.msg))})),c.on("exitFriend",(function(e){e.code?n.a.prototype.$message.error(e.msg):(r(me,e.data),r(oe,a.groupGather[m["b"]]),n.a.prototype.$message.success(e.msg))}));case 15:case"end":return t.stop()}}),t)})))()},handleChatData:function(e,t){return Object(M["a"])(regeneratorRuntime.mark((function r(){var a,n,o,u,s,c,i,d,p,f,g,h,l,b,v,y,I,O,j,k,w;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.commit,e.dispatch,n=e.state,o=e.rootState,u=o.app.user,s=n.socket,c=n.groupGather,i=t.groupData,d=t.friendData,p=t.userData,i.length){f=Object(Y["a"])(i);try{for(f.s();!(g=f.n()).done;)h=g.value,s.emit("joinGroupSocket",{groupId:h.groupId,userId:u.userId}),a(ce,h)}catch(G){f.e(G)}finally{f.f()}}if(d.length){l=Object(Y["a"])(d);try{for(l.s();!(b=l.n()).done;)v=b.value,s.emit("joinFriendSocket",{userId:u.userId,friendId:v.userId}),a(se,v)}catch(G){l.e(G)}finally{l.f()}}if(p.length){y=Object(Y["a"])(p);try{for(y.s();!(I=y.n()).done;)O=I.value,a(ue,O)}catch(G){y.e(G)}finally{y.f()}}if(j=n.activeRoom,k=n.groupGather,w=n.friendGather,j){r.next=15;break}return r.abrupt("return",a(oe,c[m["b"]]));case 15:a(oe,k[j.groupId]||w[j.userId]);case 16:case"end":return r.stop()}}),r)})))()}},ve=be,ye=(r("07ac"),G={},Object(U["a"])(G,re,(function(e,t){e.socket=t})),Object(U["a"])(G,ae,(function(e,t){e.dropped=t})),Object(U["a"])(G,ne,(function(e,t){e.activeGroupUser=t;for(var r=e.userGather,a=0,o=Object.values(t[m["b"]]);a<o.length;a++){var u=o[a];n.a.set(r,u.userId,u)}})),Object(U["a"])(G,ie,(function(e,t){e.groupGather[t.groupId].messages?e.groupGather[t.groupId].messages.push(t):n.a.set(e.groupGather[t.groupId],"messages",[t])})),Object(U["a"])(G,de,(function(e,t){t&&t.length&&n.a.set(e.groupGather[t[0].groupId],"messages",t)})),Object(U["a"])(G,pe,(function(e,t){var r=this.getters["app/user"].userId;t.friendId===r?e.friendGather[t.userId].messages?e.friendGather[t.userId].messages.push(t):n.a.set(e.friendGather[t.userId],"messages",[t]):e.friendGather[t.friendId].messages?e.friendGather[t.friendId].messages.push(t):n.a.set(e.friendGather[t.friendId],"messages",[t])})),Object(U["a"])(G,fe,(function(e,t){var r=this.getters["app/user"].userId;t&&t.length&&(t[0].friendId===r?n.a.set(e.friendGather[t[0].userId],"messages",t):n.a.set(e.friendGather[t[0].friendId],"messages",t))})),Object(U["a"])(G,oe,(function(e,t){e.activeRoom=t})),Object(U["a"])(G,ce,(function(e,t){n.a.set(e.groupGather,t.groupId,t)})),Object(U["a"])(G,ue,(function(e,t){n.a.set(e.userGather,t.userId,t)})),Object(U["a"])(G,se,(function(e,t){n.a.set(e.friendGather,t.userId,t)})),Object(U["a"])(G,ge,(function(e,t){n.a.delete(e.groupGather,t.groupId)})),Object(U["a"])(G,me,(function(e,t){n.a.delete(e.friendGather,t.friendId)})),Object(U["a"])(G,he,(function(e,t){e.unReadGather[t]?++e.unReadGather[t]:n.a.set(e.unReadGather,t,1)})),Object(U["a"])(G,le,(function(e,t){n.a.set(e.unReadGather,t,0)})),G),Ie=ye,Oe={socket:function(e){return e.socket},dropped:function(e){return e.dropped},activeGroupUser:function(e){return e.activeGroupUser},activeRoom:function(e){return e.activeRoom},groupGather:function(e){return e.groupGather},friendGather:function(e){return e.friendGather},userGather:function(e){return e.userGather},unReadGather:function(e){return e.unReadGather}},je=Oe,ke={socket:null,dropped:!1,activeGroupUser:{},activeRoom:null,groupGather:{},userGather:{},friendGather:{},unReadGather:{}},we=ke,Ge={namespaced:!0,state:we,mutations:Ie,actions:ve,getters:je},_e=Ge;n.a.use(S.a);var xe={app:X,chat:_e},$e=new S.a.Store({modules:xe}),Re=r("6944"),Se=r.n(Re),Pe=(r("3aed"),r("27fd")),Me=r("5efb"),Ce=r("b558"),De=r("ed3b"),Ee=r("3af3"),Te=r("bb76"),Ae=r("0c63"),He=r("ccb9"),Ne=r("681b"),Be=r("a600"),Le=r("55f1"),Ue=r("cdeb"),Fe=r("9839"),ze=r("39ab"),Ve=r("f933"),qe=r("9571"),Je=r("768f"),Qe=r("a071"),We=r("f64c");n.a.use(Pe["a"]),n.a.use(Me["a"]),n.a.use(Ce["a"]),n.a.use(De["a"]),n.a.use(Ee["a"]),n.a.use(Te["a"]),n.a.use(Ae["a"]),n.a.use(He["a"]),n.a.use(Ne["a"]),n.a.use(Be["a"]),n.a.use(Le["a"]),n.a.use(Ue["a"]),n.a.use(Fe["a"]),n.a.use(ze["a"]),n.a.use(Ve["a"]),n.a.use(qe["a"]),n.a.use(Je["a"]),n.a.use(Qe["a"]),n.a.prototype.$message=We["a"];var Ze=r("c32d"),Ke=r.n(Ze);r("0808");n.a.config.productionTip=!1,n.a.prototype.$moment=Ke.a,n.a.use(Se.a,{defaultOptions:{navbar:!1,title:!1,toolbar:{zoomIn:1,zoomOut:1,oneToOne:4,reset:4,prev:0,next:0,rotateLeft:4,rotateRight:4,flipHorizontal:4,flipVertical:4}}}),new n.a({router:$,store:$e,render:function(e){return e(O)}}).$mount("#app")},cebe:function(e,t){e.exports=axios}});